<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campo Minado</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #2c3e50;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            text-align: center;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        .info {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            font-weight: bold;
        }
        .tabuleiro {
            display: grid;
            grid-template-columns: repeat(9, 30px);
            grid-gap: 2px;
            margin: 20px auto;
            background: #7f8c8d;
            padding: 5px;
            border-radius: 5px;
        }
        .celula {
            width: 30px;
            height: 30px;
            background: #bdc3c7;
            border: 2px outset #ecf0f1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            font-size: 12px;
        }
        .celula.revelada {
            background: #ecf0f1;
            border: 1px solid #bdc3c7;
        }
        .celula.mina {
            background: #e74c3c;
            color: white;
        }
        .celula.bandeira {
            background: #f1c40f;
        }
        .numero-1 { color: #3498db; }
        .numero-2 { color: #27ae60; }
        .numero-3 { color: #e74c3c; }
        .numero-4 { color: #8e44ad; }
        button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }
        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .game-over div {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
        }
        .oculto {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Campo Minado</h1>
        <div class="info">
            <div>Minas: <span id="contador-minas">10</span></div>
            <div>Tempo: <span id="tempo">0</span>s</div>
        </div>
        <button onclick="reiniciarJogo()">Reiniciar</button>
        <div id="tabuleiro" class="tabuleiro"></div>
        <div class="info">
            <small>Clique esquerdo: Revelar | Clique direito: Marcar bandeira</small>
        </div>
    </div>

    <div id="fim-jogo" class="game-over oculto">
        <div>
            <h2 id="mensagem-fim"></h2>
            <button onclick="reiniciarJogo()">Jogar Novamente</button>
        </div>
    </div>

    <script>
        class CampoMinado {
            constructor() {
                this.linhas = 9;
                this.colunas = 9;
                this.totalMinas = 10;
                this.tabuleiro = [];
                this.jogo = [];
                this.fimDeJogo = false;
                this.minasMarcadas = 0;
                this.iniciar();
            }

            iniciar() {
                this.tabuleiro = Array(this.linhas).fill().map(() => Array(this.colunas).fill(0));
                this.jogo = Array(this.linhas).fill().map(() => Array(this.colunas).fill(-1));
                this.fimDeJogo = false;
                this.minasMarcadas = 0;
                this.colocarMinas();
                this.calcularNumeros();
            }

            colocarMinas() {
                let minas = 0;
                while (minas < this.totalMinas) {
                    const x = Math.floor(Math.random() * this.linhas);
                    const y = Math.floor(Math.random() * this.colunas);
                    if (this.tabuleiro[x][y] !== 9) {
                        this.tabuleiro[x][y] = 9;
                        minas++;
                    }
                }
            }

            calcularNumeros() {
                for (let x = 0; x < this.linhas; x++) {
                    for (let y = 0; y < this.colunas; y++) {
                        if (this.tabuleiro[x][y] === 9) continue;
                        let count = 0;
                        for (let dx = -1; dx <= 1; dx++) {
                            for (let dy = -1; dy <= 1; dy++) {
                                const nx = x + dx, ny = y + dy;
                                if (nx >= 0 && nx < this.linhas && ny >= 0 && ny < this.colunas) {
                                    if (this.tabuleiro[nx][ny] === 9) count++;
                                }
                            }
                        }
                        this.tabuleiro[x][y] = count;
                    }
                }
            }

            revelar(x, y) {
                if (this.fimDeJogo || this.jogo[x][y] >= 0) return false;
                
                if (this.tabuleiro[x][y] === 9) {
                    this.jogo[x][y] = 9;
                    this.fimDeJogo = true;
                    return true;
                }

                this.jogo[x][y] = this.tabuleiro[x][y];
                
                if (this.tabuleiro[x][y] === 0) {
                    for (let dx = -1; dx <= 1; dx++) {
                        for (let dy = -1; dy <= 1; dy++) {
                            const nx = x + dx, ny = y + dy;
                            if (nx >= 0 && nx < this.linhas && ny >= 0 && ny < this.colunas) {
                                if (this.jogo[nx][ny] === -1) {
                                    this.revelar(nx, ny);
                                }
                            }
                        }
                    }
                }
                return true;
            }

            marcar(x, y) {
                if (this.fimDeJogo || this.jogo[x][y] >= 0) return false;
                
                if (this.jogo[x][y] === -1) {
                    this.jogo[x][y] = -2;
                    this.minasMarcadas++;
                } else if (this.jogo[x][y] === -2) {
                    this.jogo[x][y] = -1;
                    this.minasMarcadas--;
                }
                return true;
            }

            verificarVitoria() {
                for (let x = 0; x < this.linhas; x++) {
                    for (let y = 0; y < this.colunas; y++) {
                        if (this.tabuleiro[x][y] === 9 && this.jogo[x][y] !== -2) {
                            return false;
                        }
                        if (this.tabuleiro[x][y] !== 9 && this.jogo[x][y] === -1) {
                            return false;
                        }
                    }
                }
                return true;
            }

            getMinasRestantes() {
                return this.totalMinas - this.minasMarcadas;
            }
        }

        let jogo;
        let tempo = 0;
        let intervalo;
        let jogoIniciado = false;

        function iniciar() {
            jogo = new CampoMinado();
            tempo = 0;
            jogoIniciado = false;
            document.getElementById('tempo').textContent = '0';
            document.getElementById('contador-minas').textContent = '10';
            document.getElementById('fim-jogo').classList.add('oculto');
            criarTabuleiro();
        }

        function criarTabuleiro() {
            const tabuleiro = document.getElementById('tabuleiro');
            tabuleiro.innerHTML = '';
            
            for (let x = 0; x < jogo.linhas; x++) {
                for (let y = 0; y < jogo.colunas; y++) {
                    const celula = document.createElement('div');
                    celula.className = 'celula';
                    celula.dataset.x = x;
                    celula.dataset.y = y;
                    
                    celula.addEventListener('click', () => clicarCelula(x, y, 'esquerdo'));
                    celula.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        clicarCelula(x, y, 'direito');
                    });
                    
                    tabuleiro.appendChild(celula);
                }
            }
            atualizarTabuleiro();
        }

        function clicarCelula(x, y, tipo) {
            if (!jogoIniciado) {
                jogoIniciado = true;
                iniciarTempo();
            }
            
            if (tipo === 'esquerdo') {
                jogo.revelar(x, y);
            } else {
                jogo.marcar(x, y);
            }
            
            atualizarTabuleiro();
            verificarFimJogo();
        }

        function atualizarTabuleiro() {
            const celulas = document.querySelectorAll('.celula');
            celulas.forEach(celula => {
                const x = parseInt(celula.dataset.x);
                const y = parseInt(celula.dataset.y);
                const valor = jogo.jogo[x][y];
                
                celula.className = 'celula';
                celula.textContent = '';
                
                if (valor === -1) {
                    // NÃ£o revelado
                } else if (valor === -2) {
                    celula.classList.add('bandeira');
                    celula.textContent = 'ðŸš©';
                } else if (valor === 9) {
                    celula.classList.add('revelada', 'mina');
                    celula.textContent = 'ðŸ’£';
                } else if (valor > 0) {
                    celula.classList.add('revelada', `numero-${valor}`);
                    celula.textContent = valor;
                } else if (valor === 0) {
                    celula.classList.add('revelada');
                }
            });
            
            document.getElementById('contador-minas').textContent = jogo.getMinasRestantes();
        }

        function iniciarTempo() {
            clearInterval(intervalo);
            tempo = 0;
            intervalo = setInterval(() => {
                tempo++;
                document.getElementById('tempo').textContent = tempo;
            }, 1000);
        }

        function verificarFimJogo() {
            if (jogo.fimDeJogo) {
                fimJogo(false);
            } else if (jogo.verificarVitoria()) {
                fimJogo(true);
            }
        }

        function fimJogo(vitoria) {
            clearInterval(intervalo);
            jogoIniciado = false;
            
            const mensagem = document.getElementById('mensagem-fim');
            const fim = document.getElementById('fim-jogo');
            
            if (vitoria) {
                mensagem.textContent = 'ðŸŽ‰ ParabÃ©ns! VocÃª venceu! ðŸŽ‰';
                mensagem.style.color = '#27ae60';
            } else {
                mensagem.textContent = 'ðŸ’¥ Game Over! Tente novamente.';
                mensagem.style.color = '#e74c3c';
                // Revelar todas as minas
                for (let x = 0; x < jogo.linhas; x++) {
                    for (let y = 0; y < jogo.colunas; y++) {
                        if (jogo.tabuleiro[x][y] === 9) {
                            jogo.jogo[x][y] = 9;
                        }
                    }
                }
                atualizarTabuleiro();
            }
            
            fim.classList.remove('oculto');
        }

        function reiniciarJogo() {
            clearInterval(intervalo);
            iniciar();
        }

        // Iniciar o jogo quando a pÃ¡gina carregar
        document.addEventListener('DOMContentLoaded', iniciar);
    </script>
</body>
</html>
